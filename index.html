<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PickYourCharms</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css?v=2.4">
</head>

<body>

<header class="navbar">
  <a href="index.html" class="logo-link">
    <img src="assets/home/PYC_LOGO_TEXT.png" class="logo-img" alt="PickYourCharms">
  </a>
  
  <button id="navCartBtn" class="cart-icon-btn" onclick="window.location.href='cart.html'">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 5.68c.496 2.238.242 3.666-2.203 4.095-.97.17-2.025.218-3.116.218-1.09 0-2.146-.048-3.116-.218-2.445-.429-2.7-1.857-2.203-4.095l1.263-5.68c.24-1.08.385-1.92 2.053-2.008 2.025-.107 4.053-.107 6.078 0 1.668.088 1.813.928 2.053 2.008z" />
    </svg>
  </button>
</header>

<div style="padding-bottom: 100px;">
  <section class="hero">
    <img src="assets/home/banner_vertical.png" loading="eager" fetchpriority="high">
    <div class="hero-overlay"></div>
    <div class="hero-text">
      <h1>Hand-picked.<br>Hand-styled.<br>Made by you.</h1>
      <p>Create a piece that means something.</p>
    </div>
  </section>

  <section class="entry-grid">
    <div class="entry-card interactive">
      <div class="card-image"> <img src="assets/home/model_bracelet_mobile.png" loading="lazy"> </div>
      <h2>Bracelet</h2> <p>Build it charm by charm.</p> <span class="price-hint">Starting from Rs. 249</span>
      <button class="primary-btn" onclick="startFresh('builder.html')">I want to build this →</button>
    </div>

    <div class="entry-card interactive">
      <div class="card-image"> <img src="assets/home/model_earring_mobile.png" loading="lazy"> </div>
      <h2>Earrings</h2> <p>Style both ears your way.</p> <span class="price-hint">Starting from Rs. 199</span>
      <button class="primary-btn" onclick="startFresh('earring-builder.html')">Let’s start →</button>
    </div>

    <div class="entry-card interactive combo-card">
      <div class="card-image"> <img src="assets/home/model_combo_mobile.png" loading="lazy"> <span class="combo-badge">SAVE 10% ✨</span> </div>
      <h2>Combo</h2> <p>Bracelet + Earrings</p> <span class="price-hint">Better together</span>
      <button class="primary-btn" onclick="startFresh('builder.html?mode=combo')">I want it all →</button>
    </div>

    <div class="entry-card interactive curated-card">
      <div class="card-image"> <img src="assets/home/curated_teaser.png" loading="lazy"> </div>
      <h2>Curated Pieces</h2> <p>Designed by us, for days you don’t want to decide.</p>
      <button class="secondary-btn">Explore curated designs →</button>
    </div>
  </section>
</div>

<div id="resumeBar" class="resume-bar" onclick="resumeDraft()">
  <div class="resume-info"> <span class="resume-title">I left something unfinished...</span> <span class="resume-sub">Tap to pick up where you left off</span> </div>
  <div class="resume-btn">Let's finish →</div>
</div>

<div id="verifyOrderModal" class="modal" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(4px);">
  <div class="modal-card" style="background: #fff; padding: 24px; border-radius: 20px; width: 85%; max-width: 320px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
    <h3 style="margin: 0 0 12px; font-size: 18px; font-weight: 700;">Did you place the order?</h3>
    <p style="color: #666; font-size: 14px; margin-bottom: 24px; line-height: 1.5;">Check your WhatsApp to see if the message was sent.</p>
    <div style="display: flex; gap: 12px;">
      <button onclick="handleOrderConfirm(false)" style="flex: 1; padding: 14px; border-radius: 99px; border: 1px solid #e5e5e5; background: #fff; color: #000; font-weight: 700; cursor: pointer;">No, not yet</button>
      <button onclick="handleOrderConfirm(true)" style="flex: 1; padding: 14px; border-radius: 99px; border: none; background: #000; color: #fff; font-weight: 700; cursor: pointer;">Yes, Placed!</button>
    </div>
  </div>
</div>
  <script>
window.addEventListener('pageshow', function(event) { 
  checkState(); 
  checkVerification(); 
});

// 1. Check if we just came from Checkout
function checkVerification() {
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get('verify') === 'true') {
    document.getElementById('verifyOrderModal').style.display = 'flex';
  }
}

// 2. Handle User Response
function handleOrderConfirm(isPlaced) {
  const modal = document.getElementById('verifyOrderModal');
  modal.style.display = 'none';
  
  // Clean URL (remove ?verify=true) so refresh doesn't trigger it again
  const newUrl = window.location.pathname;
  window.history.replaceState({}, document.title, newUrl);

  if (isPlaced) {
    // SUCCESS: User confirmed. NOW we delete everything.
    localStorage.removeItem('pyc_cart');
    sessionStorage.removeItem('pyc_draft');
    sessionStorage.removeItem('pyc_checkout_visited'); 
    sessionStorage.removeItem('pyc_applied_coupon');
    
    // Refresh UI to show empty state
    checkState();
  } else {
    // CANCEL: User said No. We keep the cart.
    // The Bottom Sheet will appear automatically via checkState()
  }
}

// 3. Normal State Checker (Bottom Sheet Logic)
function checkState() {
  const resumeBar = document.getElementById('resumeBar');
  const cartBtn = document.getElementById('navCartBtn');
  
  const builderDraft = sessionStorage.getItem('pyc_draft'); 
  const checkoutVisited = sessionStorage.getItem('pyc_checkout_visited'); 
  const cartData = localStorage.getItem('pyc_cart');
  const cart = cartData ? JSON.parse(cartData) : [];

  if (builderDraft) {
    resumeBar.classList.add('show');
    document.querySelector('.resume-title').textContent = "I left something unfinished...";
    document.querySelector('.resume-btn').textContent = "Let's finish →";
    resumeBar.onclick = resumeDraft; 
  } 
  else if (checkoutVisited && cart.length > 0) {
    resumeBar.classList.add('show');
    document.querySelector('.resume-title').textContent = "You're almost done! ✨";
    document.querySelector('.resume-btn').textContent = "Resume Checkout →";
    resumeBar.onclick = function() { window.location.href = 'checkout.html'; }; 
  } 
  else {
    resumeBar.classList.remove('show');
  }

  if (cart.length > 0) cartBtn.style.display = 'block';
  else cartBtn.style.display = 'none';
}

function resumeDraft() {
  const draft = JSON.parse(sessionStorage.getItem('pyc_draft'));
  if (draft && draft.url) {
    const separator = draft.url.includes('?') ? '&' : '?';
    window.location.href = draft.url + separator + 'resume=true';
  }
}

function startFresh(url) {
  sessionStorage.removeItem('pyc_draft');
  sessionStorage.removeItem('combo_bracelet_data');
  sessionStorage.removeItem('combo_earring_data');
  window.location.href = url;
}
</script>
</body>
</html>




