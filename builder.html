<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Build My Bracelet</title>

  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: #fff;
      text-align: center;
      margin: 0;
      padding: 24px;
    }

    h2 {
      margin-bottom: 12px;
    }

    /* ===== CANVAS ===== */
    .canvas {
      position: relative;
      width: 320px;
      height: 320px;
      margin: 0 auto;
    }

    /* ===== BRACELET IMAGE ===== */
    .bracelet {
      position: absolute;
      width: 200px;
      height: 200px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
    }

    /* ===== CHARMS ===== */
    .charm {
      position: absolute;
      width: 36px;
      height: 36px;
      cursor: pointer;
      transform-origin: center;
    }

    /* ===== HINT ===== */
    .hint {
      margin-top: 8px;
      font-size: 14px;
      color: #666;
    }

    /* ===== TRAY ===== */
    .tray {
      display: flex;
      justify-content: center;
      gap: 18px;
      margin-top: 20px;
    }

    .tray img {
      width: 36px;
      height: 36px;
      cursor: pointer;
    }
  </style>
</head>

<body>

<h2>Build My Bracelet</h2>

<div class="canvas" id="canvas">
  <img
    src="assets/bases/bracelet_base_gold.png"
    class="bracelet"
    alt="Bracelet Base"
  />
</div>

<div class="hint">Tap a charm to add â€¢ Click charm to remove</div>

<div class="tray">
  <img src="assets/charms/3DBowRibbon_Charm_Gold.png" onclick="addCharm(this.src)" />
  <img src="assets/charms/EvilEye_Charm_Gold.png" onclick="addCharm(this.src)" />
  <img src="assets/charms/LetterA_Charm_Gold.png" onclick="addCharm(this.src)" />
  <img src="assets/charms/NorthStar_Charm_Gold.png" onclick="addCharm(this.src)" />
  <img src="assets/charms/RedCherry_Charm_Gold.png" onclick="addCharm(this.src)" />
</div>

<script>
  const canvas = document.getElementById('canvas');

  /* ===== CENTER ===== */
  const CENTER_X = 160;
  const CENTER_Y = 160;

  /* ===== GEOMETRY (LOCKED) ===== */
  const BRACELET_RADIUS = 100;   // half of bracelet image size (200px)
  const ATTACH_OFFSET = 15;

  const ARC_START = 30;
  const ARC_END = 150;

  let charms = [];

  function addCharm(src) {
    if (charms.length >= 5) return;
    charms.push(src);
    render();
  }

  function removeCharm(index) {
    charms.splice(index, 1);
    render();
  }

  function render() {
    document.querySelectorAll('.charm').forEach(el => el.remove());
    if (charms.length === 0) return;

    const step =
      charms.length === 1
        ? 0
        : (ARC_END - ARC_START) / (charms.length - 1);

    charms.forEach((src, i) => {
      const angleDeg =
        charms.length === 1
          ? 90
          : ARC_START + step * i;

      const rad = angleDeg * Math.PI / 180;

      const x = CENTER_X + BRACELET_RADIUS * Math.cos(rad);
      const y = CENTER_Y + BRACELET_RADIUS * Math.sin(rad) + ATTACH_OFFSET;

      const img = document.createElement('img');
      img.src = src;
      img.className = 'charm';

      img.style.left = `${x - 18}px`;
      img.style.top = `${y - 18}px`;

      const tilt = angleDeg - 90;
      img.style.transform = `rotate(${tilt}deg)`;

      img.onclick = () => removeCharm(i);
      canvas.appendChild(img);
    });
  }
</script>

</body>
</html>
