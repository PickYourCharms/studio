<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Build My Bracelet</title>

<style>
/* =========================
   THEME
========================= */
:root {
  --bg: #faf7f2;
  --surface: #ffffff;
  --text: #111;
  --muted: #777;
  --accent: #000;
  --pill: rgba(0,0,0,0.04);
  --shadow-soft: 0 10px 30px rgba(0,0,0,0.06);
  --shadow-hover: 0 14px 40px rgba(0,0,0,0.12);
}

* { box-sizing: border-box; }

body {
  margin: 0;
  padding: 16px;
  font-family: system-ui, -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  text-align: center;
}

/* =========================
   HEADER
========================= */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.header button {
  background: none;
  border: none;
  font-size: 14px;
  cursor: pointer;
}

/* =========================
   TITLE
========================= */
h2 {
  margin: 10px 0 14px;
  font-size: 22px;
}

/* =========================
   METAL TOGGLE
========================= */
.metal-toggle {
  display: inline-flex;
  gap: 6px;
  background: var(--pill);
  padding: 4px;
  border-radius: 999px;
  margin-bottom: 16px;
}

.metal-toggle button {
  padding: 8px 16px;
  border-radius: 999px;
  border: none;
  cursor: pointer;
  background: transparent;
  color: var(--muted);
  transition: all .2s ease;
}

.metal-toggle button.active {
  background: var(--accent);
  color: #fff;
}

/* =========================
   CANVAS
========================= */
.canvas-wrap {
  position: relative;
  margin: 0 auto 14px;
  background: var(--surface);
  border-radius: 28px;
  padding: 20px;
  box-shadow: var(--shadow-soft);
}

.canvas {
  position: relative;
  width: min(92vw, 360px);
  aspect-ratio: 1 / 1;
  margin: 0 auto;
}

/* =========================
   BRACELET
========================= */
.bracelet {
  position: absolute;
  width: 72%;
  height: 72%;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  pointer-events: none;
}

/* =========================
   CHARMS
========================= */
.charm {
  position: absolute;
  cursor: pointer;
  transform-origin: top center;
  animation: popIn .25s ease;
}

@keyframes popIn {
  from { transform: scale(.85) rotate(var(--r)); opacity: 0; }
  to   { transform: scale(1) rotate(var(--r)); opacity: 1; }
}

.charm img {
  display: block;
  width: 46px;
  pointer-events: none;
  -webkit-user-drag: none;
  user-select: none;
}

/* =========================
   PRICE PILL
========================= */
.price-pill {
  position: absolute;
  right: 14px;
  top: 14px;
  background: #fff;
  padding: 8px 14px;
  border-radius: 999px;
  font-size: 14px;
  box-shadow: var(--shadow-soft);
  opacity: 0;
  transform: translateY(-6px);
  transition: all .2s ease;
}

.price-pill.show {
  opacity: 1;
  transform: translateY(0);
}

/* =========================
   HINT
========================= */
.hint {
  font-size: 13px;
  color: var(--muted);
  margin: 10px 0 14px;
}

/* =========================
   TRAY
========================= */
.tray-wrap {
  background: var(--surface);
  border-radius: 22px;
  padding: 16px;
  box-shadow: var(--shadow-soft);
}

.tray {
  display: flex;
  justify-content: center;
  gap: 16px;
}

.tray img {
  width: 46px;
  cursor: pointer;
  transition: transform .18s ease;
}

.tray img:active {
  transform: scale(.92);
}

/* =========================
   CTA
========================= */
.cta {
  margin-top: 18px;
  background: #000;
  color: #fff;
  padding: 18px;
  border-radius: 999px;
  font-size: 16px;
  opacity: 0;
  pointer-events: none;
  transform: translateY(8px);
  transition: all .25s ease;
}

.cta.show {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}
</style>
</head>

<body>

<div class="header">
  <button onclick="history.back()">‚Üê Back</button>
  <button onclick="handleReset()">Reset</button>
</div>

<h2>Build My Bracelet</h2>

<div class="metal-toggle">
  <button id="goldBtn" class="active" onclick="switchMetal('gold')">Gold</button>
  <button id="silverBtn" onclick="switchMetal('silver')">Silver</button>
</div>

<div class="canvas-wrap">
  <div class="price-pill" id="pricePill">Rs. 249</div>

  <div class="canvas" id="canvas">
    <img id="braceletBase"
      src="assets/bases/bracelet_base_gold.png"
      class="bracelet" />
  </div>
</div>

<div class="hint">Tap a charm to add ‚Ä¢ Tap charm to remove</div>

<div class="tray-wrap">
  <div class="tray" id="tray"></div>
</div>

<div class="cta" id="cta">Love it ¬∑ Add to Bag üõçÔ∏è</div>

<script>
/* =========================
   STATE
========================= */
let metal = 'gold';
let charms = [];

const PRICING = {
  base: 249,
  charm: 80,
  premiumExtra: 50
};

const PREMIUM = ['LetterA'];

/* =========================
   PHYSICS (LOCKED)
========================= */
const CHARM_PHYSICS = {
  size: 46,
  anchorX: 23,
  anchorY: 6,
  scale: 1,
  attachOffset: 2
};

const SLOT_ANGLES = {
  1: [90],
  2: [70,110],
  3: [60,90,120],
  4: [45,75,105,135],
  5: [40,65,90,115,140]
};

/* =========================
   FILE MAP (NO MAGIC)
========================= */
const CHARMS = {
  gold: [
    '3DBowRibbon_Charm_Gold.png',
    'EvilEye_Charm_Gold.png',
    'LetterA_Charm_Gold.png',
    'NorthStar_Charm_Gold.png',
    'RedCherry_Charm_Gold.png'
  ],
  silver: [
    '3DBowRibbon_Charm_Silver.png',
    'EvilEye_Charm_Silver.png',
    'LetterA_Charm_Silver.png',
    'NorthStar_Charm_Silver.png',
    'RedCherry_Charm_Silver.png'
  ]
};

const canvas = document.getElementById('canvas');
const tray = document.getElementById('tray');
const pricePill = document.getElementById('pricePill');
const cta = document.getElementById('cta');
const baseImg = document.getElementById('braceletBase');

/* =========================
   INIT
========================= */
renderTray();
updatePrice();

/* =========================
   FUNCTIONS
========================= */
function renderTray() {
  tray.innerHTML = '';
  CHARMS[metal].forEach(file => {
    const img = document.createElement('img');
    img.src = `assets/charms/${file}`;
    img.onclick = () => addCharm(file);
    tray.appendChild(img);
  });
}

function addCharm(file) {
  if (charms.length >= 5) return;
  charms.push(file);
  render();
}

function removeCharm(i) {
  charms.splice(i,1);
  render();
}

function render() {
  document.querySelectorAll('.charm').forEach(el => el.remove());
  if (!charms.length) {
    cta.classList.remove('show');
    pricePill.classList.remove('show');
    updatePrice();
    return;
  }

  const rect = canvas.getBoundingClientRect();
  const cx = rect.width/2;
  const cy = rect.height/2;
  const radius = rect.width*0.36;
  const angles = SLOT_ANGLES[charms.length];

  charms.forEach((file,i) => {
    const angle = angles[angles.length-1-i];
    const rad = angle*Math.PI/180;

    const x = cx + radius*Math.cos(rad);
    const y = cy + radius*Math.sin(rad) + CHARM_PHYSICS.attachOffset;

    const wrap = document.createElement('div');
    wrap.className = 'charm';
    wrap.style.left = `${x-CHARM_PHYSICS.anchorX}px`;
    wrap.style.top  = `${y-CHARM_PHYSICS.anchorY}px`;
    wrap.style.setProperty('--r', `${angle-90}deg`);
    wrap.style.transform = `rotate(${angle-90}deg)`;

    const img = document.createElement('img');
    img.src = `assets/charms/${file}`;
    img.style.width = CHARM_PHYSICS.size+'px';

    wrap.onclick = ()=>removeCharm(i);
    wrap.appendChild(img);
    canvas.appendChild(wrap);
  });

  cta.classList.add('show');
  pricePill.classList.add('show');
  updatePrice();
}

function updatePrice() {
  let total = PRICING.base;
  charms.forEach(f=>{
    total += PRICING.charm;
    if (f.includes('LetterA')) total += PRICING.premiumExtra;
  });
  pricePill.textContent = `Rs. ${total}`;
}

function switchMetal(m) {
  if (metal === m) return;
  if (charms.length && !confirm('Switching metal will reset your design. Continue?')) return;

  metal = m;
  charms = [];
  document.getElementById('goldBtn').classList.toggle('active', m==='gold');
  document.getElementById('silverBtn').classList.toggle('active', m==='silver');
  baseImg.src = `assets/bases/bracelet_base_${m}.png`;
  renderTray();
  render();
}

function handleReset() {
  if (!charms.length) return;
  if (!confirm('Reset your bracelet?')) return;
  charms=[];
  render();
}
</script>

</body>
</html>
